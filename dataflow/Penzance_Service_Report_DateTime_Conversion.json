{
	"name": "Penzance_Service_Report_DateTime_Conversion",
	"properties": {
		"type": "MappingDataFlow",
		"typeProperties": {
			"sources": [
				{
					"name": "source1"
				}
			],
			"sinks": [
				{
					"name": "sink1"
				}
			],
			"transformations": [
				{
					"name": "PNRDateConversion"
				},
				{
					"name": "ServiceDataConversion"
				}
			],
			"scriptLines": [
				"source(output(",
				"          {PNR ref.} as string,",
				"          {PNR ID} as string,",
				"          {PNR Date} as string,",
				"          {Service date} as string,",
				"          {Service type} as string,",
				"          {Class/Code} as string,",
				"          {Route Name/Details} as string,",
				"          From as string,",
				"          To as string,",
				"          {Service load} as string,",
				"          Adults as string,",
				"          Kids as string,",
				"          Infants as string,",
				"          Fare as string,",
				"          VAT as string,",
				"          {Total Tax} as string,",
				"          Tax1 as string,",
				"          Tax2 as string,",
				"          Tax3 as string,",
				"          Tax4 as string,",
				"          Total as string,",
				"          Currency as string,",
				"          {Remark/Details} as string,",
				"          {Last known invoice} as string,",
				"          {Ticket number} as string,",
				"          {Agent name} as string,",
				"          {Customer name} as string,",
				"          User as string",
				"     ),",
				"     allowSchemaDrift: true,",
				"     validateSchema: false) ~> source1",
				"ServiceDataConversion derive({PNR Date} = toTimestamp({PNR Date}, 'yyyy-MM-dd')) ~> PNRDateConversion",
				"source1 derive({Service date} = toTimestamp({Service date}, 'yyyy-MM-dd')) ~> ServiceDataConversion",
				"PNRDateConversion sink(allowSchemaDrift: true,",
				"     validateSchema: false,",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true) ~> sink1"
			]
		}
	}
}